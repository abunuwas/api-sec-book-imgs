<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36" version="26.0.16" pages="4">
  <diagram name="10.1" id="lkFxprdJkYamxbweEZGj">
    <mxGraphModel dx="1000" dy="565" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-3" value="User A" style="sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.laptop" vertex="1" parent="1">
          <mxGeometry x="10" y="230" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-5" value="Bank&#39;s servers" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/generic_server.svg;" vertex="1" parent="1">
          <mxGeometry x="490" y="50" width="28.000000000000004" height="50" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-6" value="FinTech application" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" vertex="1" parent="1">
          <mxGeometry x="280" y="230" width="18" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-7" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Welcome user A!&lt;/div&gt;" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.browserWindow;rSize=0;strokeColor=#666666;strokeColor2=#008cff;strokeColor3=#c4c4c4;mainText=,;recursiveResize=0;" vertex="1" parent="1">
          <mxGeometry x="450" y="141" width="320" height="170" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-8" value="Page 1" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.anchor;fontSize=17;fontColor=#666666;align=left;whiteSpace=wrap;" vertex="1" parent="yzB2KYVp-gDp9_4tMVdA-7">
          <mxGeometry x="60" y="12" width="110" height="26" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-9" value="https://bank.com" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.anchor;rSize=0;fontSize=17;fontColor=#666666;align=left;" vertex="1" parent="yzB2KYVp-gDp9_4tMVdA-7">
          <mxGeometry x="130" y="60" width="250" height="26" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-10" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.484;entryY=-0.015;entryDx=0;entryDy=0;entryPerimeter=0;curved=0;" edge="1" parent="1" source="yzB2KYVp-gDp9_4tMVdA-5" target="yzB2KYVp-gDp9_4tMVdA-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="605" y="75" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-11" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.138;entryY=0.484;entryDx=0;entryDy=0;entryPerimeter=0;curved=0;" edge="1" parent="1" source="yzB2KYVp-gDp9_4tMVdA-3" target="yzB2KYVp-gDp9_4tMVdA-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-12" value="Bank account credentials" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=default;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="210" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-14" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;FinTech application&#39;s database&lt;/div&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="1">
          <mxGeometry x="330" y="90" width="40" height="60" as="geometry" />
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-15" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0;entryDx=0;entryDy=37.5;entryPerimeter=0;curved=0;" edge="1" parent="1" source="yzB2KYVp-gDp9_4tMVdA-12" target="yzB2KYVp-gDp9_4tMVdA-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="225" />
              <mxPoint x="260" y="127" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yzB2KYVp-gDp9_4tMVdA-16" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.003;entryY=0.609;entryDx=0;entryDy=0;entryPerimeter=0;curved=0;" edge="1" parent="1" source="yzB2KYVp-gDp9_4tMVdA-6" target="yzB2KYVp-gDp9_4tMVdA-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="6s5NypfgmZ0frs7279ig" name="10.2">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="UxiMIKTZ3GnqCShfKizk-23" value="GET /payments/1234&lt;div&gt;Authorization: Bearer &amp;lt;legitimate_&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_token&amp;gt;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;dashed=1;strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="230" y="275" width="280" height="54" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=0;" edge="1" parent="1" source="UxiMIKTZ3GnqCShfKizk-1" target="UxiMIKTZ3GnqCShfKizk-3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="210" y="185" />
              <mxPoint x="210" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-1" value="Legitimate user" style="sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.laptop" vertex="1" parent="1">
          <mxGeometry x="110" y="170" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-7" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;curved=0;" edge="1" parent="1" source="UxiMIKTZ3GnqCShfKizk-10" target="UxiMIKTZ3GnqCShfKizk-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-12" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=0;" edge="1" parent="1" source="UxiMIKTZ3GnqCShfKizk-2" target="UxiMIKTZ3GnqCShfKizk-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-2" value="Threat actor" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn0.iconfinder.com/data/icons/kameleon-free-pack/110/Hacker-128.png" vertex="1" parent="1">
          <mxGeometry x="100.5" y="300" width="69" height="69" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-3" value="Bank API" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="540" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-5" value="GET /payments/1234&lt;div&gt;Authorization: Bearer &amp;lt;legitimate_&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_token&amp;gt;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;dashed=1;strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="230" y="190" width="280" height="54" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-6" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn4.iconfinder.com/data/icons/web-ui-color/128/Checkmark-128.png" vertex="1" parent="1">
          <mxGeometry x="320" y="240" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UxiMIKTZ3GnqCShfKizk-10" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/CrystalClear/16x16/actions/gg_ignored.png" vertex="1" parent="1">
          <mxGeometry x="326.5" y="325" width="19" height="19" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="aGpDziVCVIYju6bnXfgR" name="10.3">
    <mxGraphModel dx="1000" dy="565" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="KH2AH1txwN3TRQSQFPnI-1" value="Authorization server" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="535" y="90" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-2" value="FinTech application&lt;div&gt;(client)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="270" y="198" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-3" value="User / user agent" style="sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.laptop" vertex="1" parent="1">
          <mxGeometry x="50" y="105" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-56" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;curved=0;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-4" target="KH2AH1txwN3TRQSQFPnI-44">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="595" y="570" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-4" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn0.iconfinder.com/data/icons/kameleon-free-pack/110/Hacker-128.png" vertex="1" parent="1">
          <mxGeometry x="50" y="540" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-18" target="KH2AH1txwN3TRQSQFPnI-27">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="238" y="353" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-52" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-18" target="KH2AH1txwN3TRQSQFPnI-44">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="220" y="500" />
              <mxPoint x="220" y="500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-18" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="80" width="10" height="440" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-19">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="150" y="170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="310" y="170" />
              <mxPoint x="310" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-19" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="510" y="82" width="10" height="360" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-27" target="KH2AH1txwN3TRQSQFPnI-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-27" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="325" y="265" width="10" height="175" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-38" value="User logs in with the authorization server" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="205" y="80" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-39" value="Authorization server issues the authorization code" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#b85450;dashed=1;fillColor=#f8cecc;" vertex="1" parent="1">
          <mxGeometry x="186.25" y="135" width="287.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-40" value="User agent&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;sends the code to&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;the client&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;spacing=5;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="161" y="295" width="149" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-41" value="The FinTech application exchanges the authorization code for an access and ID token" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#82b366;dashed=1;fillColor=#d5e8d4;" vertex="1" parent="1">
          <mxGeometry x="345" y="278" width="149" height="68" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-43" value="Authorization server issues the access and ID token" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#b85450;dashed=1;fillColor=#f8cecc;" vertex="1" parent="1">
          <mxGeometry x="345" y="390" width="149" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-44" value="Resource server" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="535" y="470" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.819;entryY=0.886;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="510" y="434.9999999999999" as="sourcePoint" />
            <mxPoint x="333.19000000000005" y="435.04999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="470" y="435" />
              <mxPoint x="470" y="435" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-48" value="The client forwards the access and ID token to the user agent" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#82b366;dashed=1;fillColor=#d5e8d4;" vertex="1" parent="1">
          <mxGeometry x="161" y="368" width="149" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-53" value="User agent uses the access token and ID token to prove their identity and access data in the resource server" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="186.25" y="456" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.847;entryY=0.806;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-27" target="KH2AH1txwN3TRQSQFPnI-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="237" y="435" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-55" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.255;entryY=0.091;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="KH2AH1txwN3TRQSQFPnI-18" target="KH2AH1txwN3TRQSQFPnI-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="230" y="115" />
              <mxPoint x="230" y="115" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-57" value="Threat actor attempts to forge an ID token with the details of another user to access their data" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#9673a6;dashed=1;fillColor=#e1d5e7;" vertex="1" parent="1">
          <mxGeometry x="186.25" y="524" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KH2AH1txwN3TRQSQFPnI-58" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/CrystalClear/16x16/actions/gg_ignored.png" vertex="1" parent="1">
          <mxGeometry x="324" y="559.5" width="21" height="21" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="2CrL97nAWcQY_oXuFT0W" name="10.4">
    <mxGraphModel dx="1167" dy="690" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-1" value="" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.browserWindow;rSize=0;strokeColor=#666666;strokeColor2=#008cff;strokeColor3=#c4c4c4;mainText=,;recursiveResize=0;fillColor=#f5f5f5;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="500" y="71" width="410" height="260" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-2" value="Page 1" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.anchor;fontSize=17;fontColor=#666666;align=left;whiteSpace=wrap;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-1">
          <mxGeometry x="60" y="12" width="110" height="26" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-3" value="https://malicious-site.com" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.anchor;rSize=0;fontSize=17;fontColor=#666666;align=left;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-1">
          <mxGeometry x="130" y="60" width="250" height="26" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div&gt;&amp;lt;script&amp;gt;&lt;/div&gt;window.onload = function() {&lt;br&gt;&amp;nbsp; &amp;nbsp; window.location.href = authorization_request_url;&lt;br&gt;};&lt;div&gt;&amp;lt;/script&amp;gt;&lt;/div&gt;" link="window.onload = function() {&#xa;    window.location.href = &quot;https://www.example.com&quot;; // Replace with your target URL&#xa;};" id="OJDmj5fTwl5VcTCA4R0q-5">
          <mxCell style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#6c8ebf;dashed=1;spacing=10;fillColor=#dae8fc;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-1">
            <mxGeometry x="10" y="160" width="300" height="90" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-6" value="" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#b85450;fillColor=none;dashed=1;strokeWidth=2;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-1">
          <mxGeometry x="150" y="196" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-19" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=0;" edge="1" parent="1" source="OJDmj5fTwl5VcTCA4R0q-4" target="OJDmj5fTwl5VcTCA4R0q-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-4" value="/authorize?response_type=code&amp;amp;client_id=s6BhdR&amp;amp;redirect_uri=https://malicious-site.com" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="555" y="350" width="510" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-7" value="" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#b85450;fillColor=none;dashed=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="915" y="355" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-9" value="" style="sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.laptop" vertex="1" parent="1">
          <mxGeometry x="10" y="185" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.001;entryY=0.496;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="OJDmj5fTwl5VcTCA4R0q-9" target="OJDmj5fTwl5VcTCA4R0q-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-11" value="User visits a malicious website, where they are inmediately redirected to their identity provider with an authorization request" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="160" y="120" width="240" height="75" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-12" value="" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.browserWindow;rSize=0;strokeColor=#666666;strokeColor2=#008cff;strokeColor3=#c4c4c4;mainText=,;recursiveResize=0;fillColor=#f5f5f5;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="10" y="280" width="460" height="260" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-13" value="Page 1" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.anchor;fontSize=17;fontColor=#666666;align=left;whiteSpace=wrap;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-12">
          <mxGeometry x="60" y="12" width="110" height="26" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-14" value="https://malicious-site.com" style="strokeWidth=1;shadow=0;dashed=0;align=center;html=1;shape=mxgraph.mockup.containers.anchor;rSize=0;fontSize=17;fontColor=#666666;align=left;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-12">
          <mxGeometry x="130" y="60" width="250" height="26" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div&gt;&amp;lt;script&amp;gt;&lt;/div&gt;window.onload = function() {&lt;br&gt;&amp;nbsp; &amp;nbsp; const code = URL(document.location.toString()).searchParams.get(&quot;code&quot;);&lt;div&gt;&amp;nbsp; &amp;nbsp; fetch(&quot;https://identity-provider.com/oauth/token&quot;,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; {method: &quot;POST&quot;, &quot;body&quot;: new URLSearchParams({code: code})&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ).then(response =&amp;gt; response.json())&lt;br&gt;};&lt;div&gt;&amp;lt;/script&amp;gt;&lt;/div&gt;&lt;/div&gt;" link="window.onload = function() {&#xa;    window.location.href = &quot;https://www.example.com&quot;; // Replace with your target URL&#xa;};" id="OJDmj5fTwl5VcTCA4R0q-15">
          <mxCell style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=default;dashed=1;spacing=10;" vertex="1" parent="OJDmj5fTwl5VcTCA4R0q-12">
            <mxGeometry x="10" y="120" width="440" height="130" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-17" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.782;entryY=-0.049;entryDx=0;entryDy=0;entryPerimeter=0;curved=0;" edge="1" parent="1" source="OJDmj5fTwl5VcTCA4R0q-5" target="OJDmj5fTwl5VcTCA4R0q-4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="954" y="260" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-18" value="Identity provider" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="600" y="430" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1.001;entryY=0.695;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="OJDmj5fTwl5VcTCA4R0q-18" target="OJDmj5fTwl5VcTCA4R0q-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OJDmj5fTwl5VcTCA4R0q-21" value="Since the user is already logged in, the identity provider responds with an authorization code and redirects the user back to the malicious site" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="540" y="500" width="240" height="75" as="geometry" />
        </mxCell>
        <mxCell id="caUt-e1Rc8NBEUd8zzvk-3" value="1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;strokeWidth=2;fontFamily=Tahoma;spacingBottom=4;spacingRight=2;strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="154" y="110" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="caUt-e1Rc8NBEUd8zzvk-4" value="2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;strokeWidth=2;fontFamily=Tahoma;spacingBottom=4;spacingRight=2;strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="535" y="490" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="caUt-e1Rc8NBEUd8zzvk-6" value="Upon redirection, the malicious site fetches the authorization code from the URL and exchanges it right way for an access token" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#d6b656;dashed=1;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="205" y="510" width="240" height="75" as="geometry" />
        </mxCell>
        <mxCell id="caUt-e1Rc8NBEUd8zzvk-7" value="3" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;strokeWidth=2;fontFamily=Tahoma;spacingBottom=4;spacingRight=2;strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="1">
          <mxGeometry x="200" y="500" width="20" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
